/* RESET & BASE */
* { box-sizing: border-box; }
body { font-family: 'Montserrat', sans-serif; margin: 0; height: 100vh; overflow: hidden; }

/* SCROLLBAR */
.custom-scrollbar::-webkit-scrollbar { width: 6px; }
.custom-scrollbar::-webkit-scrollbar-track { background: #f1f1f1; }
.custom-scrollbar::-webkit-scrollbar-thumb { background: #c1c1c1; border-radius: 3px; }

/* EDITOR WRAPPER */
#editor-wrapper {
    position: relative; 
    flex: 1; 
    background: white; 
    border: 1px solid #d1d5db; 
    border-radius: 0.5rem; 
    overflow: hidden; /* Container không scroll, chỉ con scroll */
}

/* CẤU HÌNH 2 LỚP CHỒNG KHÍT 100% */
#highlight-layer, #text-layer {
    position: absolute; top: 0; left: 0; right: 0; bottom: 0;
    padding: 24px; 
    box-sizing: border-box;
    
    /* FONT & TEXT - PHẢI GIỐNG HỆT NHAU */
    font-family: inherit; font-size: inherit; line-height: 1.6;
    white-space: pre-wrap; 
    word-wrap: break-word; overflow-wrap: break-word;
    
    margin: 0; border: 0;
    
    /* FIX LỖI NHẢY DÒNG: Luôn hiện thanh cuộn để chiều rộng content không đổi */
    overflow-y: scroll; 
    overflow-x: hidden;
}

/* LỚP TRÊN: NHẬP LIỆU (TEXT LAYER) */
#text-layer {
    z-index: 2;
    background: transparent;
    outline: none;
    color: black; /* Mặc định là đen (chế độ gõ) */
    caret-color: black;
}

/* Placeholder */
#text-layer:empty::before {
    content: attr(placeholder); color: #9ca3af; pointer-events: none; display: block;
}

/* LỚP DƯỚI: HIGHLIGHT LAYER */
#highlight-layer {
    z-index: 1;
    background: white;
    color: transparent; /* Chữ gốc tàng hình, chỉ hiện nền mark */
    pointer-events: none; /* Cho phép chuột bấm xuyên qua xuống text-layer */
    
    /* Ẩn thanh cuộn của lớp highlight cho đẹp, nhưng vẫn giữ hành vi scroll */
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none;  /* IE */
}
#highlight-layer::-webkit-scrollbar { 
    width: 0; height: 0; display: none; /* Chrome/Safari */
}

/* STYLE SCROLLBAR CHO TEXT LAYER (LỚP TRÊN) */
#text-layer::-webkit-scrollbar { width: 6px; }
#text-layer::-webkit-scrollbar-thumb { background: rgba(0,0,0,0.2); border-radius: 3px; }

/* HIGHLIGHT COLORS */
mark {
    color: transparent !important; /* Chữ trong mark cũng tàng hình để không đè chữ đen */
    background-color: transparent;
    border-radius: 4px;
    padding: 0; margin: 0;
    
    /* Quan trọng: Trick để hiển thị màu highlight nhưng vẫn cho thấy chữ đen của layer trên */
    box-shadow: inset 0 0 0 100px var(--hl-bg);
    border-bottom: 2px solid rgba(0,0,0,0.1);
}

/* Định nghĩa biến màu cho mark */
.hl-yellow { --hl-bg: #eab308; border-bottom: none; box-shadow: inset 0 0 0 100px #fde047, 0 0 0 2px #fde047; } 
.hl-pink   { --hl-bg: #ec4899; }
.hl-blue   { --hl-bg: #3b82f6; }
.hl-green  { --hl-bg: #10b981; }
.hl-orange { --hl-bg: #f97316; }
.hl-purple { --hl-bg: #8b5cf6; }
.hl-red    { --hl-bg: #ef4444; }

/* TAGS & UI KHÁC (Giữ nguyên) */
#keywords-tags .tag {
    background: #eff6ff; color: #1e40af; padding: 4px 10px; border-radius: 20px;
    font-size: 11px; display: inline-flex; align-items: center; gap: 6px;
    border: 1px solid #93c5fd; margin: 2px;
}
#keywords-tags .tag .remove-tag { cursor: pointer; font-weight: bold; }
#punctuation-list .punctuation-item { display: flex; gap: 4px; padding: 4px; border-bottom: 1px solid #eee; }
#punctuation-list input { flex: 1; padding: 4px; border: 1px solid #ddd; font-size: 11px; }
#notification-container { position: fixed; top: 20px; right: 20px; z-index: 9999; }
.notification { padding: 10px 20px; color: white; border-radius: 5px; margin-bottom: 5px; font-size: 13px; }
.notification.success { background: #10b981; }
.notification.error { background: #ef4444; }
.hidden { display: none !important; }
